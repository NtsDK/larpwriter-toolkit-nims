<!DOCTYPE html>

<!-- Copyright 2015 Timofey Rechkalov <ntsdk@yandex.ru>, Maria Sidekhmenova <matilda_@list.ru>

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
   limitations under the License.  -->

<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title l10n-id="header-page-title"></title>

<link rel="stylesheet" type="text/css" href="styles/libs.min.css"  media="screen" />
<link rel="stylesheet" type="text/css" href="styles/nims.min.css"  media="screen" />
<link rel="stylesheet" type="text/css" href="tests/tests.min.css"  media="screen" />

<script src="mode.js"></script>
<script src="js/libs.min.js"></script>

</head>
<body onload="PageManager.onLoad()">
  <script src="js/common.min.js"></script>
  <script src="js/scripts.min.js"></script>
  <script src="js/pages.min.js"></script>
  <script src="js/resources.min.js"></script>
  
  <script src="tests/tests.min.js"></script>
  <script src="tests/specs.min.js"></script>

  <div id="navigation">
  
  </div>

  <div class="block" id="contentArea"></div>

  <div class="hidden">
    <div id="overviewDiv">
      <div style="display:flex;justify-content: space-around;">
        <div style="flex-grow:1;margin-right: 10px;">
          <div id="commonInfoDiv" class="panel panel-default">
            <div class="panel-body">
              <table class="table table-bordered" style="width: auto;">
                <tr>
                  <td><span l10n-id="overview-name"></span></td>
                  <td><input id="gameNameInput" class="adminOnly"></input></td>
                </tr>
                <tr>
                  <td><span l10n-id="overview-pre-game-start-date"></span></td>
                  <td><input id="preGameDatePicker" class="adminOnly"></input></td>
                </tr>
                <tr>
                  <td><span l10n-id="overview-pre-game-end-date"></span></td>
                  <td><input id="gameDatePicker" class="adminOnly"></input></td>
                </tr>
                <tr>
                  <td><span l10n-id="overview-last-save-time"></span></td>
                  <td id="lastSaveTime"></td>
                </tr>
              </table>
            </div>
          </div>
          
          <div style="display:flex;margin-right:10px;">
            <div class="navigation-button overviewInfoButton" id="descriptionPanel" l10n-id="overview-descr"></div>
            <div class="navigation-button overviewInfoButton" id="diagramsPanel" l10n-id="overview-diagrams"></div>
          </div>
        
          <div class="panel panel-default" >
            <div class="panel-body">
              <div id="descriptionPanelContainer" class="overviewContainer">
                <textarea id="gameDescription" class="adminOnly"></textarea>
              </div>
              <div id="diagramsPanelContainer" class="overviewContainer">
                <div class="diagram-container" style="">
                  <div class="diagram-subcontainer">
                    <div>
                      <h4 l10n-id="overview-event-count-diagram"></h4>
                      <div id="storyEventsHist" class="overviewHist"></div>
                    </div>
                    <div>
                      <h4 l10n-id="overview-character-count-diagram"></h4>
                      <div id="storyCharactersHist" class="overviewHist"></div>
                    </div>
                  </div>
                  <div class="diagram-subcontainer">
                    <div>
                      <h4 l10n-id="overview-character-stories-diagram"></h4>
                      <div id="characterStoriesHist" class="overviewHist"></div>
                    </div>
                    <div>
                      <h4 l10n-id="overview-story-completeness-diagram"></h4>
                      <div id="eventCompletenessHist" class="overviewHist"></div>
                    </div>
                  </div>
                  <div class="diagram-subcontainer">
                    <div>
                      <h4 l10n-id="overview-character-symbols-diagram"></h4>
                      <div id="characterSymbolsHist" class="overviewHist"></div>
                    </div>
                  </div>
                  <div class="diagram-subcontainer">
                    <div>
                      <h4 l10n-id="overview-object-belonging-diagrams"></h4>
                      <div style="display:flex;justify-content:center;">
                        <div style="flex-grow:1;flex-basis:0;text-align: center;">
                          <canvas id="characterChart" width="200" height="100"></canvas><br>
                          <span l10n-id="header-characters"></span>
                        </div>
                        <div style="flex-grow:1;flex-basis:0;text-align: center;">
                          <canvas id="storyChart" width="200" height="100"></canvas><br>
                          <span l10n-id="header-stories"></span>
                        </div>
                        <div style="flex-grow:1;flex-basis:0;text-align: center;">
                          <canvas id="groupChart" width="200" height="100"></canvas><br>
                          <span l10n-id="header-groups"></span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div id="profileDiagrams"></div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="panel panel-default" style="flex-grow:0;flex-basis: 400px;">
          <div class="panel-heading">
            <h3 class="panel-title" l10n-id="overview-stats"></h3>
          </div>
          <div class="panel-body">
            <table class="table table-bordered" style="width: auto;">
            <tbody>
              <tr><td><span class="statisticsLabel" l10n-id="overview-story-count"></span></td><td><span class="statisticsValue" id="storyNumber"></span>        </td></tr>
              <tr><td><span class="statisticsLabel" l10n-id="overview-character-count"></span></td><td><span class="statisticsValue" id="characterNumber"></span>    </td></tr>
              <tr><td><span class="statisticsLabel" l10n-id="overview-event-count"></span></td><td><span class="statisticsValue" id="eventsNumber"></span>       </td></tr>
              <tr><td><span class="statisticsLabel" l10n-id="overview-user-count"></span></td><td><span class="statisticsValue" id="userNumber"></span>         </td></tr>
              <tr><td><span class="statisticsLabel" l10n-id="overview-first-event"></span></td><td><span class="statisticsValue" id="firstEvent"></span>         </td></tr>
              <tr><td><span class="statisticsLabel" l10n-id="overview-last-event"></span></td><td><span class="statisticsValue" id="lastEvent"></span>          </td></tr>
              <tr><td><span class="statisticsLabel" l10n-id="overview-symbol-count"></span></td><td><span class="statisticsValue" id="textCharacterNumber"></span></td></tr>
              <tr><td><span class="statisticsLabel" l10n-id="overview-story-completeness"></span></td><td><span class="statisticsValue" id="storyCompleteness"></span>  </td></tr>
              <tr><td><span class="statisticsLabel" l10n-id="overview-general-completeness"></span></td><td><span class="statisticsValue" id="generalCompleteness"></span></td></tr>
            </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>


    <div id="charactersDiv">

      <div class="panel panel-default">
        <div class="panel-heading">
          <a href="#" panel-toggler="#charactersDiv div.panel-body"> <h3 class="panel-title" l10n-id="characters-character-managing"></h3></a>
        </div>
        <div class="panel-body">
          <input id="characterNameInput" l10n-placeholder-id="characters-character-name"></input>
          <button id="createCharacterButton" l10n-id="common-add"></button>
          <br> <span l10n-id="common-rename-from"></span> <select id="fromName" class="select2-mono-selector"></select> 
          <span l10n-id="common-to"></span> <input
            id="toName" l10n-placeholder-id="characters-new-character-name"></input>
          <button id="renameCharacter" l10n-id="common-ok"></button>
          <br> <select id="characterRemoveSelector" class="select2-mono-selector" ></select>
          <button id="removeCharacterButton" l10n-id="common-remove"></button>
        </div>
      </div>
    
      <div id="charactersNavigation"></div>
      <div id="charactersContent"></div>
    </div>


      
    <div id="characterProfile">
      <div class="panel panel-default">
        <div class="panel-body">
          <table>
            <tr>
              <th l10n-id="characters-characters"></th>
            </tr>
            <tr>
              <td><input selector-filter="#bioEditorSelector"><br>
              <select size=20 id="bioEditorSelector"></select></td>
              <td>
                <div id="profileContentDiv"></div>
              </td>
            </tr>
          </table>
        </div>
      </div>

    </div>

    <div id="characterProfileConfigurer">
      <div class="panel panel-default">
        <div class="panel-body">
          <span l10n-id="characters-profile-item-name"></span>
          <input id="profileItemNameInput" class="itemNameInput adminOnly"></input> 
          <span l10n-id="characters-profile-item-type"></span>
          <select id="profileItemTypeSelector" class="adminOnly"></select> 
          <span l10n-id="characters-profile-item-position"></span>
          <select id="profileItemPositionSelector" class="adminOnly"></select>
          <button id="createProfileItemButton" class="adminOnly" l10n-id="common-add"></button><br> 
          <select id="moveProfileItemSelector" class="adminOnly"></select> 
          <span l10n-id="characters-profile-item-position"></span>
          <select id="moveProfileItemPositionSelector" class="adminOnly"></select>
          <button id="moveProfileItemButton" class="adminOnly" l10n-id="characters-move-item"></button><br>
          <select id="removeProfileItemSelector" class="adminOnly"></select>
          <button id="removeProfileItemButton" class="adminOnly" l10n-id="common-remove"></button>
          <br>
    
          <table class="table table-bordered" style="width: auto;">
          <thead>
            <tr>
              <th>№</th>
              <th l10n-id="characters-table-profile-item-name"></th>
              <th l10n-id="characters-profile-item-type"></th>
              <th l10n-id="characters-profile-item-default-value"></th>
              <th l10n-id="characters-profile-item-do-export"></th>
            </tr>
          </thead>
          <tbody id="profileConfigBlock"></tbody>
          </table>
        </div>
      </div>

    </div>
    
    <div class="groups-tab">
    
      <div class="panel panel-default">
        <div class="panel-heading">
          <a href="#" panel-toggler=".groups-tab .group-control-area">
            <h3 class="panel-title" l10n-id="groups-groups"></h3>
          </a>
        </div>
        <div class="panel-body group-control-area">

          <div class="group-management-area">
            <div class="entity-management">
              <div>
                <input class="create-entity-input" l10n-placeholder-id="groups-group-name"></input>
                <button class="create-entity-button" l10n-id="common-add"></button>
              </div>
              <div>
                <span l10n-id="common-rename-from"></span> <select
                  class="rename-entity-select select2-mono-selector"
                >
                </select> <span l10n-id="common-to"></span>
                <input class="rename-entity-input"
                  l10n-placeholder-id="groups-new-group-name"
                ></input>
                <button class="rename-entity-button" l10n-id="common-ok"></button>
              </div>
              <div>
                <select class="remove-entity-select" class="select2-mono-selector">
                </select>
                <button class="remove-entity-button" l10n-id="common-remove"></button>
              </div>
            </div>
          </div>
        </div>
      </div>
    
      <div class="sub-tab-navigation"></div>
      <div class="sub-tab-content"></div>
    </div>
    
    <div class="group-profile-tab">
      <div class="panel panel-default">
        <div class="panel-body">
          <table>
            <tr>
              <th l10n-id="groups-groups"></th>
            </tr>
            <tr>
              <td><input selector-filter=".group-profile-tab .entity-selector"><br>
              <select size=20 class="entity-selector"></select></td>
              <td>
                <div>
                  <table class="table">
                    <tbody class="entity-profile"></tbody>
                  </table>
                </div>
              </td>
            </tr>
          </table>
        </div>
      </div>
    </div>
    
    <div class="group-schema-tab">
      <div class="panel panel-default">
        <div class="panel-body">
          <div class="schema-container"></div>
        </div>
      </div>
    </div>

    <div class="investigation-board-tab">
      <div class="panel panel-default">
        <div class="panel-body">
          <div class="schema-container"></div>
        </div>
      </div>
      <div class="board-add-node-popup board-popup hidden">
        <h3 class="panel-title">Добавить группу</h3>
        <select class="group-add-select"></select>
        <button class="group-add-button" l10n-id="common-add"></button>
        <br>
        <h3 class="panel-title">Создать ресурс</h3>
        <div>
          <input class="create-entity-input" l10n-placeholder-id2="groups-group-name"></input>
          <button class="create-entity-button" l10n-id="common-add"></button>
        </div>
        <button class="cancel-node-adding-button" l10n-id="common-cancel"></button>
      </div>
      
      <div class="board-edit-group-popup board-popup hidden">
        <h3 class="panel-title">Заменить группу</h3>
        <select class="group-switch-select"></select>
        <button class="group-switch-button" l10n-id="common-ok"></button>
        
        <h3 class="panel-title">Заметки</h3>
        <textarea class="group-notes-editor" rows="3"></textarea>
        
        <button class="group-save-notes-button" l10n-id="common-ok"></button>
        <button class="cancel-group-editing-button" l10n-id="common-cancel"></button>
      </div>
      
      <div class="board-edit-resource-popup board-popup hidden">
        <h3 class="panel-title">Переименовать ресурс</h3>
        <div>
          <input class="rename-entity-input"
            l10n-placeholder-id="groups-new-group-name"
          ></input>
          <button class="rename-entity-button" l10n-id="common-ok"></button>
        </div>
        <button class="cancel-resource-editing-button" l10n-id="common-cancel"></button>
      </div>

      <div class="board-add-edge-popup board-popup hidden">
        <input class="add-edge-label-input" l10n-placeholder-id="investigation-board-enter-edge-label">
        <button class="save-edge-button" l10n-id="common-ok"></button>
        <button class="cancel-add-edge-button" l10n-id="common-cancel"></button>
      </div>
    </div>

    <div id="characterFilterDiv">
    
      <div class="panel panel-default">
        <div class="panel-heading">
          <a href="#" panel-toggler="#characterFilterDiv .group-control-area">
            <h3 class="panel-title" l10n-id="groups-groups"></h3>
          </a>
        </div>
        <div class="panel-body group-control-area">

          <div class="group-editing-area">
            <h3 class="panel-title" l10n-id="groups-show-groups"></h3>
            <div class="entity-editing">
              <select class="save-entity-select" class="select2-mono-selector">
              </select><br>
              <button class="show-entity-button" l10n-id="groups-show-group-filter"></button>
              <br>
              <button class="save-entity-button" l10n-id="groups-save-group-filter"></button>
            </div>
          </div>

          <div class="group-management-area">
            <h3 class="panel-title" l10n-id="groups-manage-groups"></h3>
            <div class="entity-management">
              <div>
                <input class="create-entity-input" l10n-placeholder-id="groups-group-name"></input>
                <button class="create-entity-button" l10n-id="common-add"></button>
              </div>
              <div>
                <span l10n-id="common-rename-from"></span> <select
                  class="rename-entity-select select2-mono-selector"
                >
                </select> <span l10n-id="common-to"></span>
                <input class="rename-entity-input"
                  l10n-placeholder-id="groups-new-group-name"
                ></input>
                <button class="rename-entity-button" l10n-id="common-ok"></button>
              </div>
              <div>
                <select class="remove-entity-select" class="select2-mono-selector">
                </select>
                <button class="remove-entity-button" l10n-id="common-remove"></button>
              </div>
            </div>
          </div>

        </div>
      </div>
      <table>
        <tr>
          <td>
            <div class="panel panel-default">
              <div class="panel-heading">
                <a href="#" panel-toggler="#characterFilterDiv div.column-select-area">
                  <h3 class="panel-title" l10n-id="character-filter-show-profile-item"></h3>
                </a>
              </div>
              <div class="panel-body column-select-area">
                <select multiple id="profileItemSelector"></select>
              </div>
            </div>
            <div class="panel panel-default">
              <div class="panel-heading">
                <a href="#" panel-toggler="#characterFilterDiv div.filter-settings-area">
                  <h3 class="panel-title" l10n-id="character-filter-filter"></h3>
                </a>
              </div>
              <div class="panel-body filter-settings-area panel-resizable">
                <span l10n-id="character-filter-results"></span> <span id="filterResultSize"></span><br>
                <button id="download-filter-table" l10n-id="character-filter-download-filter-table"></button>
                <br><br>
                
                <div class="filter-settings-panel"></div>
              </div>
            </div>
          </td>
          <td>
            <div class="panel panel-default">
              <div class="panel-body">
                <table  class="table table-striped table-bordered">
                <thead id="filterHead"></thead>
                <tbody id="filterContent"></tbody>
                </table>
              </div>
            </div>
          </td>
        </tr>
      </table>
    </div>
    


    <div id="storiesDiv">
      <div style="display: flex;justify-content:space-around;">
        <div class="panel panel-default">
          <div class="panel-heading">
            <a href="#" panel-toggler="#storiesDiv div.first-panel">
              <h3 class="panel-title" l10n-id="stories-stories"></h3>
            </a>
          </div>
          <div class="panel-body first-panel">
            <select id="storySelector"></select>
          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading">
            <a href="#" panel-toggler="#storiesDiv div.second-panel">
              <h3 class="panel-title" l10n-id="stories-story-management"></h3>
            </a>
          </div>
          <div class="panel-body second-panel">
            <input id="createStoryName" l10n-placeholder-id="stories-story-name"></input>
            <button id="createStoryButton"  l10n-id="common-add"></button>
            <br> <span l10n-id="common-rename-from"></span> <select id="fromStory"></select> <span l10n-id="common-to"></span> <input
              id="toStory" l10n-placeholder-id="stories-new-story-name"></input>
            <button id="renameStoryButton" l10n-id="common-ok"></button>
            <br> <select id="storyRemoveSelector"></select>
            <button id="removeStoryButton" l10n-id="common-remove"></button>
          </div>
        </div>
      </div>

      <div>
        <div style="display:flex;">
          <div id="storiesNavigationLeft" style="flex-grow:1;width:50%;margin-right:10px;" ></div>
          <div id="storiesNavigationRight" style="flex-grow:1;width:50%;justify-content: flex-end;" ></div>
        </div>
        <div style="display:flex;">
          <div style="flex-grow:1;width:50%;margin-right:10px;" id="storiesContentLeft"></div>
          <div id="storiesContentRight" style="flex-grow:1;width:50%;"></div>
        </div>
      </div>

    </div>

    <div id="masterStoryDiv2">
      <div class="panel panel-default">
        <div class="panel-body">
           <textarea id="masterStoryArea" class="isStoryEditable"></textarea>
        </div>
      </div>
    </div>


    <div id="storyEventsDiv">
      <div class="panel panel-default">
        <div class="panel-body">
          <div style="display:flex;flex-wrap:wrap;justify-content:space-around;">
            <div style="flex-grow:1;margin-right:10px;">
              <a href="#" panel-toggler="#storyEventsDiv div.event-creation-area">
                <h3 style="margin-top:8px;"  l10n-id="stories-event-creation"></h3>
              </a>
              <div class="event-creation-area">
                <span l10n-id="stories-event-name"></span><input id="eventNameInput" class="isStoryEditable"></input><br>
                <span l10n-id="stories-event-descr"></span><br>
                <textarea id="eventTextInput" class="eventText isStoryEditable"></textarea><br>
                <span l10n-id="stories-event-position"></span><select id="positionSelector" class="isStoryEditable eventPositionSelector"></select>
                <button id="createEventButton" class="isStoryEditable" l10n-id="common-add"></button>
              </div>
            </div>
            <div style="flex-grow:1;">
              <a href="#" panel-toggler="#storyEventsDiv div.event-management-area">
                <h3 style="margin-top:8px;" l10n-id="stories-event-management"></h3>
              </a>
              <div class="event-management-area">
                <select id="moveEventSelector" class="isStoryEditable eventEditSelector"></select> 
                <span l10n-id="stories-event-position"></span><select id="movePositionSelector" class="isStoryEditable eventPositionSelector"></select>
                <button id="moveEventButton" class="isStoryEditable" l10n-id="stories-move-event"></button>
                <br> <select id="cloneEventSelector" class="isStoryEditable eventEditSelector"></select>
                <button id="cloneEventButton" class="isStoryEditable" l10n-id="stories-clone-event"></button>
                <br> <select id="mergeEventSelector" class="isStoryEditable eventEditSelector"></select>
                <button id="mergeEventButton" class="isStoryEditable" l10n-id="stories-merge-events"></button>
                <br> <select id="removeEventSelector" class="isStoryEditable eventEditSelector"></select>
                <button id="removeEventButton" class="isStoryEditable" l10n-id="common-remove"></button>
              </div>
            </div>
          </div>
          
        </div>
      </div>

      <div class="panel panel-default">
        <div class="panel-body">
          <table class="table table-bordered">
            <thead id="eventBlockHead"></thead>
            <tbody id="eventBlock"></tbody>
          </table>
        </div>
      </div>
    </div>



    <div id="storyCharactersDiv">
      <div class="panel panel-default">
        <div class="panel-body">
          <a href="#" panel-toggler="#storyCharactersDiv div.character-management-area">
            <h3 l10n-id="stories-story-character-management"></h3>
          </a>
          <div class="character-management-area">
            <select id="storyCharactersAddSelector" class="isStoryEditable"></select>
            <button id="storyCharactersAddButton" class="isStoryEditable" l10n-id="common-add"></button>
            <br> <span l10n-id="stories-replace-character"></span><select id="storyCharactersFromSelector" class="isStoryEditable"></select>
            <span l10n-id="common-on"></span> <select id="storyCharactersToSelector" class="isStoryEditable"></select>
            <button id="storyCharactersSwitchButton" class="isStoryEditable" l10n-id="common-ok"></button>
            <br> <select id="storyCharactersRemoveSelector" class="isStoryEditable"></select>
            <button id="storyCharactersRemoveButton" class="isStoryEditable" l10n-id="common-remove"></button>
          </div>
          <br>
    
          <div style="display:flex;flex-wrap: wrap; justify-content:space-around;">
            <div style="flex-grow:0;margin-right:10px;max-width: 450px;">
              <a href="#" panel-toggler="#storyCharactersDiv table.character-inventory-area">
                <h3 l10n-id="stories-inventory"></h3>
              </a>
              <table class="table table-bordered character-inventory-area">
                <thead id="storyCharactersTableHead"></thead>
                <tbody id="storyCharactersTable"></tbody>
              </table>
            </div>
            <div style="flex-grow:1;max-width: 450px;">
              <a href="#" panel-toggler="#storyCharactersDiv table.character-activity-area">
                <h3 l10n-id="stories-activity"></h3>
              </a>
              <table class="table table-bordered table-striped character-activity-area">
                <thead id="story-characterActivityTableHead"></thead>
                <tbody id="story-characterActivityTable"></tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="eventPresenceDiv">
      <div class="panel panel-default">
        <div class="panel-body" style="overflow-x:auto;">
          <table cellspacing=0 cellpadding=0 style="width: 100%;">
            <tr>
              <td>
                <span l10n-id="stories-show-characters"></span><br>
                <select multiple id="eventPresenceSelector"></select>
              </td>
              <td>
                <table  cellspacing=0 cellpadding=0 class="table table-bordered">
                  <thead id="eventPresenceTableHead"></thead>
                  <tbody id="eventPresenceTable"></tbody>
                </table>
              </td>
            </tr>
          </table>
        </div>
      </div>
    </div>



    <div id="eventsDiv">
      <div class="panel panel-default">
        <div class="panel-body">
          <input type="checkbox" id="finishedStoryCheckbox"/><label for="finishedStoryCheckbox" l10n-id="adaptations-show-only-unfinished-stories"></label>
        </div>
      </div>
      <div style="display:flex;">
        <div style="flex-grow:0;flex-basis: 210px;">
            <div id="personalStoriesCharacterContainer">
              <div class="panel panel-default">
                <div class="panel-heading">
                  <h3 class="panel-title" l10n-id="adaptations-story"></h3>
                </div>
                <div class="panel-body panel-resizable">
                  <input selector-filter="#events-storySelector"><br>
                  <select id="events-storySelector" size=10></select>
                </div>
              </div>
              <div class="panel panel-default">
                <div class="panel-heading">
                  <h3 class="panel-title" l10n-id="adaptations-filter"></h3>
                </div>
                <div class="panel-body">
                  
                  <input type="radio" name="adaptationFilter" value="ByCharacter" id="adaptationFilterByCharacter">
                  <label for="adaptationFilterByCharacter" l10n-id="adaptations-by-characters"></label><br>
                  <input type="radio" name="adaptationFilter" value="ByEvent" id="adaptationFilterByEvent">
                  <label for="adaptationFilterByEvent" l10n-id="adaptations-by-events"></label><br>
                  
                  <div id="events-characterSelectorDiv">
                    <h4 l10n-id="adaptations-characters"></h4>
                    <select id="events-characterSelector" multiple></select>
                  </div>
                  <div id="events-eventSelectorDiv" class="hidden">
                    <h4 l10n-id="adaptations-events"></h4>
                    <select id="events-eventSelector" multiple size=15></select>
                  </div>
                </div>
              </div>
            </div>
          </div>
            <div class="panel panel-default" style="flex-grow:1;">
              <div class="panel-heading">
                <h3 class="panel-title" l10n-id="adaptations-adaptations"></h3>
              </div>
              <div class="panel-body">
                 <div class="eventMainPanelRow" style="margin:0;">
                   <div class="eventMainPanelRow-left">
                     <h3 l10n-id="adaptations-origin"></h3>
                   </div>
                   <div class="eventMainPanelRow-right">
                     <h3 l10n-id="adaptations-adaptation"></h3>
                   </div>
                 </div>
                 <div id="personalStories">
                 </div>
              </div>
            </div>
      </div>
    </div>

    <div id="briefingsDiv">
      <div id="briefingsNavigation"></div>
      <div id="briefingsContent" ></div>
    </div>

    <div id="accessManagerDiv">
      <div style="display: flex;justify-content: space-around;">
        <div class="panel panel-default">
          <div class="panel-heading">
            <a href="#" panel-toggler="#accessManagerDiv div.user-management-area">
              <h3 class="panel-title" l10n-id="admins-user-management"></h3>
            </a>
          </div>
          <div class="panel-body user-management-area">
            <span l10n-id="admins-user-name"></span><input id="userNameInput" class="adminOnly"></input>
            <span l10n-id="admins-user-password"></span><input id="userPasswordInput" class="adminOnly"></input>
            <button id="createUserButton" class="adminOnly" l10n-id="common-add"></button>
            <br> <span l10n-id="admins-change-password"></span> <select id="passwordUserName" class="adminOnly"></select> 
            <span l10n-id="common-on"></span> <input
              id="newPassword" class="adminOnly"></input>
            <button id="changePasswordButton" class="adminOnly" l10n-id="common-ok"></button>
            <br> <select id="userRemoveSelector" class="adminOnly"></select>
            <button id="removeUserButton" class="adminOnly" l10n-id="common-remove"></button>
          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading">
            <a href="#" panel-toggler="#accessManagerDiv div.special-actions-area">
              <h3 class="panel-title" l10n-id="admins-special-actions"></h3>
            </a>
          </div>
          <div class="panel-body special-actions-area" style="display: flex;justify-content: space-between;">
            <div>
            	<span l10n-id="admins-admin"></span><span id="currentAdministrator"></span><br>
            	<select id="newAdminSelector" class="adminOnly"></select>
                <button id="newAdminButton" class="adminOnly" l10n-id="admins-assign-admin"></button><br>
            	<span l10n-id="admins-editor"></span><span id="currentEditor"></span>
                <button id="removeEditorButton" class="editorOrAdmin" l10n-id="admins-remove-editor"></button><br>
            	<select id="newEditorSelector" class="adminOnly"></select>
                <button id="newEditorButton" class="adminOnly" l10n-id="admins-assign-editor"></button><br>
            </div>
          	<div>
              <span l10n-id="admins-assign-adaptation-rights"></span><br>
            	<input type="radio" name="adaptationRights" class="adaptationRights adminOnly" value="ByStory" id="adaptationRightsByStory">
              <label for="adaptationRightsByStory" l10n-id="admins-by-stories"></label><br>
    		      <input type="radio" name="adaptationRights" class="adaptationRights adminOnly" value="ByCharacter" id="adaptationRightsByCharacter">
              <label for="adaptationRightsByCharacter" l10n-id="admins-by-characters"></label><br>
            </div>
          </div>
        </div>
      </div>
      <div id="accessManagerContent" >
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title" l10n-id="admins-editing-rights"></h3>
          </div>
          <div class="panel-body" style="display:flex;">
            <div>
              <span l10n-id="admins-rights"></span>
              <div id="permissionTable"></div>
            </div>
            <div>
              <table>
                <tr>
                  <th l10n-id="admins-characters"></th>
                  <th l10n-id="admins-stories"></th>
                  <th l10n-id="admins-groups"></th>
                  <th l10n-id="admins-users"></th>
                </tr>
                <tr>
                  <td>
                    <input selector-filter="#permission-selector__characters"><br>
                    <select size=15 id="permission-selector__characters" multiple></select>
                  </td>
                  <td>
                    <input selector-filter="#permission-selector__stories"><br>
                    <select size=15 id="permission-selector__stories" multiple></select>
                  </td>
                  <td>
                    <input selector-filter="#permission-selector__groups"><br>
                    <select size=15 id="permission-selector__groups" multiple></select>
                  </td>
                  <td>
                    <select size=10 id="userPermissionSelector" style="min-width: 100px;"></select>
                  </td>
                </tr>
              </table>
              <button id="assignPermissionButton" l10n-id="admins-assign-rights"></button>
              <button id="removePermissionButton" class="adminOnly" l10n-id="admins-take-away-rights"></button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="briefingPreviewDiv">
      <div class="panel panel-default">
        <div class="panel-heading">
          <select id="briefingCharacter"></select><br> 
        </div>
        <div class="panel-body">
          <table>
            <tr>
              <td style="padding: 0px 30px 0px 0px;">
                <input type="radio" name="tabMode" value="adaptations" id="adaptationsModeRadio" />
                <label for="adaptationsModeRadio" l10n-id="briefings-adaptations-mode"></label>
                <br>
                <input type="radio" name="tabMode" value="proofreading" id="proofreadingModeRadio" />
                <label for="proofreadingModeRadio" l10n-id="briefings-proofreading-mode"></label>
              </td>
              <td style="padding: 0px 30px 0px 0px;">
                <input type="radio" name="eventsGroupBy" value="story" id="eventGroupingByStoryRadio" />
                <label for="eventGroupingByStoryRadio" l10n-id="briefings-group-by-story"></label>
                <br>
                <input type="radio" name="eventsGroupBy" value="time" id="eventGroupingByTimeRadio" />
                <label for="eventGroupingByTimeRadio" l10n-id="briefings-sort-by-timeline"></label>
              </td>
              <td>
                <input type="checkbox" id="hideAllPanelsCheckbox" />
                <label for="hideAllPanelsCheckbox" l10n-id="briefings-hide-all-panels"></label>
                <br>
                <input type="checkbox" id="disableHeadersCheckbox" />
                <label for="disableHeadersCheckbox" l10n-id="briefings-disable-headers"></label>
              </td>
            </tr>
          </table>
        </div>
      </div>
      
      <div id="briefingContent"></div>
      
    </div>

    <div id="briefingExportDiv">
      <div class="panel panel-default">
        <div class="panel-heading">
          <a href="#" panel-toggler="#briefingExportDiv div.export-panel-body">
            <h3 class="panel-title" l10n-id="briefings-export-settings"></h3>
          </a>
        </div>
        <div class="panel-body export-panel-body" style="display:flex;justify-content:space-around;">
          
          <fieldset>
            <legend l10n-id="briefings-export-mode"></legend>
            <input type="checkbox" id="toSeparateFileCheckbox"/> 
            <label for="toSeparateFileCheckbox" l10n-id="briefings-each-briefing-to-own-file"></label><br>
          </fieldset>
        
          <fieldset>
            <legend l10n-id="briefings-briefing-selection"></legend>
            <input type="radio" name="exportSelection" value="all" id="exportSelectionAll"/>
            <label for="exportSelectionAll" l10n-id="briefings-print-all"></label> <br> 
            <input type="radio" name="exportSelection" value="specific" id="exportSelectionSpecific"/>
            <label for="exportSelectionSpecific" l10n-id="briefings-print-partly"></label> <br> 
            <input type="radio" name="exportSelection" value="multiple" id="exportSelectionMultiple"/>
            <label for="exportSelectionMultiple" l10n-id="briefings-exact-multiselect"></label> <br> 
            
            <div id="briefingSelector" class="hidden">
              <span l10n-id="briefings-briefings-amount"></span> 
              <select id="briefingNumberSelector"></select><br>
              <span l10n-id="briefings-briefings-range"></span>
              <select id="briefingIntervalSelector"></select>
            </div>
            
            <div id="briefingMultiSelect" class="hidden">
              <input selector-filter="#briefingMultiSelector"><br>
              <select id="briefingMultiSelector" multiple size=15 ></select>
            </div>
          </fieldset>
        </div>
      </div>
          
      <div style="display:flex;margin-right:10px;">
        <div class="navigation-button exportModeButton" id="simpleExport" l10n-id="briefings-simple-export"></div>
        <div class="navigation-button exportModeButton" id="advancedWordExport" l10n-id="briefings-advanced-docx-export"></div>
        <div class="navigation-button exportModeButton" id="advancedTextExport" l10n-id="briefings-advanced-txt-export"></div>
      </div>
          
      <div class="panel panel-default">
        <div class="panel-body">
          <div id="simpleExportContainer" class="exportContainer">
            <button id="makeBriefingsByTime" l10n-id="briefings-make-docx-by-time"></button><br>
            <button id="makeBriefingsByStory" l10n-id="briefings-make-docx-by-stories"></button><br>
            <button id="makeDefaultTextBriefings" l10n-id="briefings-make-txt"></button><br><br>
            
            <button id="makeInventoryList" l10n-id="briefings-make-inventory"></button><br>
          </div>
          
          <div id="advancedWordExportContainer" class="exportContainer">
            <div class="file-upload">
              <label> <input type="file" name="file"
                id="docxBriefings"> <span l10n-id="briefings-upload-template-and-make-export"></span>
              </label>
            </div>
          </div>
          
          <div id="advancedTextExportContainer" class="exportContainer">
            <div >
              <h3 l10n-id="briefings-template"></h3>
              <textarea id="templateArea"></textarea><br>
              <label l10n-id="briefings-enter-text-file-type"></label>
              <input id="textTypeSelector" value="txt"/>
              <button id="previewTextOutput" l10n-id="briefings-preview"></button><br>
              <button id="showRawData" class="hidden" l10n-id="briefings-raw-data"></button>
              <button id="convertToDocxTemplate" l10n-id="briefings-convert-to-docx-template"></button>
              <button id="generateByDocxTemplate" l10n-id="briefings-generate-by-docx-template"></button>
              <button id="makeCustomTextBriefings" l10n-id="briefings-export"></button>
            </div>
            <div >
              <h3 l10n-id="briefings-exported-text"></h3>
              <textarea id="textBriefingPreviewArea"></textarea>
            </div>
          </div>
              
          <h3 l10n-id="briefings-export-status"></h3>
          <div id="exportStatus"></div>
        </div>
      </div>
    </div>



    <div id="timelineDiv">

      <div class="flexRoot">
        <div class="storySelectorContainer">
          <div class="panel panel-default">
            <div class="panel-heading">
              <h3 class="panel-title" l10n-id="timeline-stories"></h3>
            </div>
            <div class="panel-body panel-resizable">
              <input selector-filter="#timelineStorySelector"><br>
              <select size=20 id="timelineStorySelector" multiple></select>
            </div>
          </div>
        </div>
        <div class="visualObjectContainer full-screen-elem" id="timelineContainer"></div>
      </div>

    </div>

    <div id="logoutForm">
      <form class="form-horizontal login-form" name="login-form" method="POST" action="/logout">
        <button type="submit" class="654btn 654btn-primary" data-loading-text="Sending...">Exit</button>
      </form> 
    </div>

    <div id="logViewerDiv">
      <div class="panel panel-default">
        <div class="panel-body">
          <label l10n-id="log-viewer-page"></label><select id="logPageSelector"></select>
          <table class="table table-bordered table-striped character-activity-area">
            <thead>
              <th>№</th>
              <th l10n-id="log-viewer-date"></th>
              <th l10n-id="log-viewer-user"></th>
              <th l10n-id="log-viewer-action"></th>
              <th l10n-id="log-viewer-params"></th>
            </thead>
            <tbody id="logData"></tbody>
          </table>
        </div>
      </div>
    </div>
    
    <div id="socialNetworkDiv">
      <div id="socialNetworkWarning" class="alert alert-warning"></div>
      <div class="flexRoot">
      
<!--         <div style="flex-basis:150px;flex-grow:0; display:flex;flex-direction:column;flex-wrap:wrap;height:500px"> -->
        <div class="storySelectorContainer" id="commonSettingsContainer">
          <div class="panel panel-default">
            <div class="panel-body">
              <span l10n-id="social-network-show-node"></span><br>
              <select id="nodeFocusSelector"></select>
            </div>
          </div>
          
          <div class="panel panel-default">
            <div class="panel-heading">
              <h3 class="panel-title" l10n-id="social-network-common-settings"></h3>
            </div>
            <div class="panel-body">
              <a href="#" panel-toggler="#socialNetworkDiv div.network-coloring-area">
                <h4 l10n-id="social-network-color-nodes"></h4>
              </a> 
              <div class="network-coloring-area">
                <select id="networkNodeGroupSelector"></select> <br>
                <span l10n-id="social-network-legend"></span>
                <div id="colorLegend"></div>
              </div>
    
              <a href="#" panel-toggler="#socialNetworkDiv div.network-filter-area">
                <h4 l10n-id="social-network-selection"></h4> 
              </a>
              
              <div class="network-filter-area">
                <select size=3 id="networkSubsetsSelector"></select>
                
                <div id="networkCharacterDiv" class="hidden">
                  <h4 l10n-id="social-network-characters"></h4> 
                  <input selector-filter="#networkCharacterSelector"><br>
                  <select size=20 id="networkCharacterSelector"
                    multiple></select>
                </div>
      
                <div id="networkStoryDiv" class="hidden">
                  <h4 l10n-id="social-network-stories"></h4> 
                  <input selector-filter="#networkStorySelector"><br>
                  <select size=20 id="networkStorySelector" multiple></select>
                </div>
              </div>
            </div>
          </div>

          <div class="panel panel-default">
            <div class="panel-heading">
              <h3 class="panel-title" l10n-id="social-network-private-settings"></h3>
            </div>
            <div class="panel-body">
              <a href="#" panel-toggler="#socialNetworkDiv div.network-type-area">
                <h4 l10n-id="social-network-social-network"></h4> 
              </a>
              
              <div class="network-type-area">
                <select size=4 id="networkSelector"></select>
      
                <div id="activityBlock" class="hidden">
                  <h4 l10n-id="social-network-activity"></h4> <select size=4 id="activitySelector" multiple></select>
                </div>
              </div>
    
              <button id="drawNetworkButton" l10n-id="social-network-draw"></button><br>
              <button id="hideNetworkSettingsButton" l10n-id="social-network-hide-panel"></button>
            </div>
          </div>
        </div>
<!--         </div> -->

        <div class="storySelectorContainer2 hidden"
          id="showSettingsButtonContainer">
          <button id="showNetworkSettingsButton">+</button>
        </div>

        <div class="visualObjectContainer full-screen-elem" id="socialNetworkContainer"></div>
<!--         <div class="visualObjectContainer" style="display:flex;flex-direction:column;"> -->
<!--           <div id="socialNetworkContainer" style="flex-base:100px;flex-grow:1;"> -->
<!--         </div> -->
        </div>
      </div>
      
      <div id="chatDiv">
        <p class="lead">Welcome to chat!</p>
        <input type="text" name="message" id="chatMessage" />
        <button id="sendMessageButton">Send</button>
        <ul id="messages"></ul>
      </div>
      
      <div id="warehouse"></div>
    </div>

    <div id="debugNotification" class="hidden"></div>

</body>
</html>